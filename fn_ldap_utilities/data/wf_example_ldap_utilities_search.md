<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: LDAP Utilities: Search

## Function - LDAP Utilities: Search

### API Name
`ldap_utilities_search`

### Output Name
``

### Message Destination
`fn_ldap_utilities`

### Pre-Processing Script
```python
##  LDAP Utilities: Search - pre-processing script ##
inputs.ldap_domain_name = 'domain1'
inputs.ldap_search_base = "dc=example,dc=com"
inputs.ldap_search_filter = "(&(objectClass=person)(|(cn=%ldap_param%)(mail=%ldap_param%)))"
inputs.ldap_search_attributes = "cn,displayName,mail,pwdLastSet,whenCreated,title,department,userAccountControl,manager,distinguishedName"
inputs.ldap_search_param = artifact.value
```

### Post-Processing Script
```python
##  LDAP Utilities: Search - post-processing script ##

#  Globals
ENTRY_TO_DATATABLE_MAP = {
    "cn": "cn",
    "displayName": "displayName",
    "mail": "email_address",
    "pwdLastSet": "password_last_set",
    "whenCreated": "when_created",
    "title": "title",
    "department": "department",
    "manager": "manager"
}


# Processing if the function is a success
if(results.success):
  for entry in results["entries"]:
    
    if entry is None:
      break
    
    else:
      # Add Row
      row = incident.addRow("ldap_users_query_results")
      
      for k in ENTRY_TO_DATATABLE_MAP:

        if entry[k] is None:
          row[ENTRY_TO_DATATABLE_MAP[k]] = "N/A"

        else:
          try:
            # if 'entry[k]' is empty
            if len(entry[k]) == 0:
              row[ENTRY_TO_DATATABLE_MAP[k]] = "N/A"
            
            # Handle for Active Directory
            elif isinstance(entry[k], unicode):
              row[ENTRY_TO_DATATABLE_MAP[k]] = entry[k]
            
            # Handle for OpenLdap
            else:
              row[ENTRY_TO_DATATABLE_MAP[k]] = entry[k][0]
          
          except IndexError:
            row[ENTRY_TO_DATATABLE_MAP[k]] = "N/A"
```

---

